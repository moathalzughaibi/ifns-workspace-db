name: Secrets Smoke Test
on:
  workflow_dispatch:
jobs:
  check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Check required secrets
        env:
          NEEDS: "NOTION_TOKEN,IFNS_Workspace_DB"
        run: |
          missing=0
          IFS="," read -ra arr <<< "$NEEDS"
          for key in "${arr[@]}"; do
            if [ -z "${!key}" ]; then
              echo "::error ::Missing secret: $key"
              missing=1
            else
              echo " $key present"
            fi
          done
          if [ "$missing" = "1" ]; then exit 1; fi
        shell: bash
        env:
          NOTION_TOKEN: ${{ secrets.NOTION_TOKEN }}
          IFNS_Workspace_DB: ${{ secrets.IFNS_Workspace_DB }}
